# 软件著作权登记申请源代码处理工具
本工具可以根据用户预先编制的规则，将一个软件项目中的各种源代码文件整合为一个文件，并执行去除注释、去除空行、加页眉页码和加封面的操作，最终生成一个符合中国软件著作权登记要求的Word文档。

## 许可

本程序为自由软件；您可依据自由软件基金会所发表的GNU通用公共授权条款，对本程序再次发布和/或修改；无论您依据的是本授权的第三版，或（您可选的）任一日后发行的版本。

本程序是基于使用目的而加以发布，然而不负任何担保责任；亦无对适售性或特定目的适用性所为的默示性担保。详情请参照GNU通用公共授权。

本程序虽然为自由软件，但依然受《著作权法》、《计算机软件保护条例》和国际公约的保护。如果违反授权，将受到严厉的民事和刑事制裁，并将在法律许可的范围内受到最大程度的起诉。

本程序已完成著作权登记，登记号：2020SR1108559。

## 处理过程

工具会依次读入规则文件和源代码文件，并将所有读取到的源代码文件整合成一个文件，并按照规则文件中的描述，去除掉所有的行注释和块注释。

随后，工具会去除所有空行，并开始生成Word文件。Word文件的第一页为源代码文档的封面，内容为设置的软件名称与版本号+“源代码”，无页眉，不编页码。随后的页面为处理后的源代码，每一页的页眉为设置的软件名称与版本号+“源代码”，并且右上角编有页码。

最后，工具会将Word文件输出到用户提前设置的保存位置。

## 使用说明
首先，单击“选择目录”按钮，选择要处理的软件项目的源代码目录。点击“选择目录”按钮后，会弹出文件夹选择对话框，选择目录后，单击“确定”按钮，完成选择。

然后，单击“选择规则”按钮，选择要使用的处理规则文件。点击“选择规则”按钮后，会弹出文件选择对话框，选择规则文件后，单击“确定”按钮，完成选择。

接着，单击“设置生成文件”按钮，设置保存输出结果的位置。点击“设置生成文件”按钮后，会弹出文件保存对话框，设置好保存位置后，单击“确定按钮”，完成设置。

随后，在“软件名称与版本号”文本框中输入软件名称与版本号。软件名称与版本号应当与计算机软件著作权登记申请表中填报的一致。

最后，单击“开始处理”按钮。如下图所示，在工具处理的各个阶段，工具都会在列表框中输出运行信息。在处理成功后，工具会弹出对话框。

## 规则文件编制说明
规则文件文件名应当为`rule.txt`，内容由一个或多个文件规则块组成。文件规则块以`File`指令开始，以`End`指令结束，中间包含对行注释或块注释的描述。如果编程语言不支持块注释，在文件规则块中可以不描述块注释。

`File`指令用于描述规则适用的文件类型，语法为`File "扩展名"`。拓展名应包含分隔符“`.`”。

*例：*`File ".cs"`

`LineComment`指令用于描述行注释符号，语法为`LineComment "符号"`。

*例：*`LineComment "//"`

`BlockCommentStart`指令用于描述块注释开始符号，语法为`BlockCommentStart "符号"`。

*例：*`BlockCommentStart "/*"`

`BlockCommentEnd`指令用于描述行注释符号，语法为`BlockCommentEnd "符号"`。

*例：*`BlockCommentEnd "*/"`

以下是适用于C\#语言的示例规则文件：

``` numberLines
File ".cs"
LineComment "//"
BlockCommentStart "/*"
BlockCommentEnd "*/"
End
```
